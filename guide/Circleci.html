<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Circleci automation - OHD-Documentation</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">user Guide</li><li class="chapter-item expanded "><a href="../guide/installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../guide/Circleci.html" class="active"><strong aria-hidden="true">3.</strong> Circleci automation</a></li><li class="chapter-item expanded "><a href="../guide/usage.html"><strong aria-hidden="true">4.</strong> Usage</a></li><li class="chapter-item expanded "><a href="../guide/demo.html"><strong aria-hidden="true">5.</strong> Demo</a></li><li class="chapter-item expanded affix "><li class="part-title">Project Summary</li><li class="chapter-item expanded "><a href="../guide/about.html"><strong aria-hidden="true">6.</strong> About</a></li><li class="chapter-item expanded "><a href="../guide/use_case.html"><strong aria-hidden="true">7.</strong> Use case</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="../misc/references.html"><strong aria-hidden="true">8.</strong> References</a></li><li class="chapter-item expanded affix "><li class="part-title">Developers</li><li class="chapter-item expanded "><a href="../misc/developers.html"><strong aria-hidden="true">9.</strong> Developers</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">OHD-Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2><a class="header" href="#deployment-of-onsite-health-diagnostic-website" id="deployment-of-onsite-health-diagnostic-website">Deployment of Onsite Health Diagnostic website</a></h2>
<p>After integrating the backend and testing the application the final part left is deploying of the complete application to the cloud platform so that user can use our website anywhere in the world.<br>
For deploying the complete application the tools we used here are <code>circle-ci</code> for building CI/CD pipeline,<code>Docker</code> for Contenarization and <code>Heroku</code> for cloud hosting .For the automation of the project we have applied <strong>Mlops</strong> strategy i.e Machine learning operations for deploying our complete application in the automated way.
<br>
Now we will explain how we will explain about creating CI/CD pipeline using circle-ci
<br></p>
<h4><a class="header" href="#create-a-file-dockerfile-with-below-content" id="create-a-file-dockerfile-with-below-content">Create a file &quot;Dockerfile&quot; with below content</a></h4>
<pre><code>FROM python:3.7
COPY ./app
WORKDIR /app
ENTRYPOINT [&quot;python&quot;]
CMD [&quot;main.py&quot;]
</code></pre>
<h4><a class="header" href="#create-a-procfile-with-following-content" id="create-a-procfile-with-following-content">Create a &quot;Procfile&quot; with following content</a></h4>
<p><code>web:gunicorn main:app $PORT</code></p>
<h4><a class="header" href="#create-a-file-circleciconfigyml-with-following-content" id="create-a-file-circleciconfigyml-with-following-content">create a file &quot;.circleci\config.yml&quot; with following content</a></h4>
<pre><code>version: 2.1
orbs:
  heroku: circleci/heroku@1.0.1                                                                  
jobs:                                                  
  build-and-test:
    executor: heroku/default
    docker:
      - image: circleci/python:3.6.2-stretch-browsers
        auth:
          username: mydockerhub-user
          password: $DOCKERHUB_PASSWORD  # context / project UI env-var reference
    steps:
      - checkout
      - restore_cache:
          key: deps1-{{ .Branch }}-{{ checksum &quot;requirements.txt&quot; }}
      - run:
          name: Install Python deps in a venv
          command: |
            echo 'export TAG=0.1.${CIRCLE_BUILD_NUM}' &gt;&gt; $BASH_ENV
            echo 'export IMAGE_NAME=python-circleci-docker' &gt;&gt; $BASH_ENV
            python3 -m venv venv
            . venv/bin/activate
            pip install --upgrade pip
            pip install -r requirements.txt
      - save_cache:
          key: deps1-{{ .Branch }}-{{ checksum &quot;requirements.txt&quot; }}
          paths:
            - &quot;venv&quot;
      - run:
          command: |
            . venv/bin/activate
            python -m pytest -v test/test.py
      - store_artifacts:
          path: test-reports/
          destination: tr1
      - store_test_results:
          path: test-reports/
      - setup_remote_docker:
          version: 19.03.13
      - run:
          name: Build and push Docker image
          command: |
            docker build -t $DOCKERHUB_USER/$IMAGE_NAME:$TAG .
            docker login -u $DOCKERHUB_USER -p $DOCKER_HUB_PASSWORD_USER docker.io
            docker push $DOCKERHUB_USER/$IMAGE_NAME:$TAG
  deploy:
    executor: heroku/default
    steps:
      - checkout
      - run:
          name: Storing previous commit
          command: |
            git rev-parse HEAD &gt; ./commit.txt
      - heroku/install
      - setup_remote_docker:
          version: 18.06.0-ce
      - run:
          name: Pushing to heroku registry
          command: |
            heroku container:login
            #heroku ps:scale web=1 -a $HEROKU_APP_NAME
            heroku container:push web -a $HEROKU_APP_NAME
            heroku container:release web -a $HEROKU_APP_NAME

workflows:
  build-test-deploy:
    jobs:
      - build-and-test
      - deploy:
          requires:
            - build-and-test
          filters:
            branches:
              only:
                - main
</code></pre>
<h4><a class="header" href="#replicate-the-requirementstxt-file-to-your-local-node" id="replicate-the-requirementstxt-file-to-your-local-node">Replicate the requirements.txt file to your local node</a></h4>
<p><code>pip freeze &gt; requirements.txt</code></p>
<h4><a class="header" href="#initialize-git-repo" id="initialize-git-repo">initialize git repo</a></h4>
<pre><code>git init
git add .
git commit -m &quot;first commit&quot;
git branch -M main
git remote add origin &lt;github_url&gt;
git push -u origin main
</code></pre>
<h4><a class="header" href="#create-a-account-at-circle-ci" id="create-a-account-at-circle-ci">create a account at circle ci</a></h4>
<p>https://circleci.com/login/</p>
<h4><a class="header" href="#create-an-account-at-heroku" id="create-an-account-at-heroku">create an account at heroku</a></h4>
<p>https://id.heroku.com/login</p>
<h4><a class="header" href="#create-api-authenticated-key-at-heroku" id="create-api-authenticated-key-at-heroku">Create api authenticated key at heroku</a></h4>
<p>Go to <code>Heroku Profile Page</code> and then click on navaigation bar named <code>applications</code> and then click on <code>create authrization</code> finally enter <code>description</code> and then you will be able to generate API key.</p>
<h4><a class="header" href="#create-a-account-at-docker-hub" id="create-a-account-at-docker-hub">create a account at docker hub</a></h4>
<p>https://hub.docker.com/login</p>
<h4><a class="header" href="#setup-project" id="setup-project">Setup project</a></h4>
<p>https://app.circleci.com/projects/github/Avnish327030/setup/</p>
<h4><a class="header" href="#select-project-setting-in-circleci-and-below-environment-variable" id="select-project-setting-in-circleci-and-below-environment-variable">Select project setting in CircleCI and below environment variable</a></h4>
<pre><code>DOCKERHUB_USER
DOCKER_HUB_PASSWORD_USER
HEROKU_API_KEY
HEROKU_APP_NAME
HEROKU_EMAIL_ADDRESS
DOCKER_IMAGE_NAME= &lt;any random name starting with char ending with int64&gt; eg:onsite1234
</code></pre>
<h4><a class="header" href="#to-update-the-modification" id="to-update-the-modification">To update the modification</a></h4>
<pre><code>git add .
git commit -m &quot;proper message&quot;
git push
</code></pre>
<h3><a class="header" href="#thats-it-kudos-successfully-made-automated-deployment-using-circle-ci-pipeline" id="thats-it-kudos-successfully-made-automated-deployment-using-circle-ci-pipeline">THATS IT KUDOS SUCCESSFULLY MADE AUTOMATED DEPLOYMENT USING CIRCLE-CI PIPELINE</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../guide/installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../guide/usage.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../guide/installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../guide/usage.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
